{"version":3,"file":"writing_component_tests-19fa2e4a.js","sources":["../../docs/component_driven_development/writing_component_tests.mdx"],"sourcesContent":["import { Meta, Subtitle } from '@storybook/blocks';\n\n<Meta title=\"Docs/Component Driven Development/Unit Tests\" />\n\n# Component Unit Tests\n\n## How do we write unit tests\n\nWe use the [Vitest](https://vitest.dev/) unit testing framework and [@vue/test-utils](https://vue-test-utils.vuejs.org/)\nto test our components.\n\n## Where to add unit tests\n\nUnit tests in the `Dialtone Vue` project are written in the component sub directory with the following naming\nstructure `<COMPONENT_NAME>.test.js`. If a test requires a [fixture](https://en.wikipedia.org/wiki/Test_fixture),\nthen it is added to the `tests/fixtures` directory.\n\n## What should be tested\n\n### Logic\n\n#### Data\n\nWe should ensure that the data layer of our components is tested.\n\n##### Props\n\nWe should assert that the props are correctly used within the component. This can include displaying the correct variant\nwhen a given set of props are provided or presenting the user with a given message.\n\n#### Interactivity\n\n##### Reactivity\n\nEnsure that the component correctly updates when there is an interaction. It is recommended that we test the output of\nthe component rather than the component's data.\n\n###### Example\n\n```js\ndescribe('MyComponent Tests', () => {\n  let wrapper;\n  let button;\n\n  const propsData = {\n    some: 'prop',\n  };\n\n  beforeEach(() => {\n    wrapper = shallowMount(MyComponent, { propsData });\n    button = wrapper.find('[data-qa=\"button\"]');\n  });\n\n  it('Updates the button text', () => {\n    button.trigger('click');\n\n    expect(button.text()).toBe('Button text');\n  });\n});\n```\n\n##### Events\n\nWe also need to validate that the correct custom events are being emitted from our component when we interact with it.\n\n###### Example\n\n```js\ndescribe('MyComponent Tests', () => {\n  let wrapper;\n\n  const propsData = {\n    some: 'prop',\n  };\n\n  beforeEach(() => {\n    wrapper = shallowMount(MyComponent, { propsData });\n  });\n\n  it('Emits myCustomEvent', () => {\n    wrapper.vm.$emit('myCustomEvent');\n\n    expect(wrapper.emitted().myCustomEvent.length).toBe(1);\n  });\n});\n```\n\n#### Accessibility\n\n##### Focus Management\n\nWe should assert that any manually controlled focus is correctly managed.\n\n###### Example\n\nIf the component moves focus when a menu is opened, we should assert that the focus has moved onto the correct element\nwithin the menu.\n\n```js\ndescribe('MyComponent Tests', () => {\n  let wrapper;\n  let button;\n\n  const propsData = {\n    some: 'prop',\n  };\n\n  beforeEach(() => {\n    wrapper = shallowMount(MyComponent, {\n      propsData,\n      attachTo: document.body,\n    });\n    button = wrapper.find('[data-qa=\"button\"]');\n  });\n\n  it('Moves focus onto first dropdown menu item', () => {\n    button.trigger('click');\n\n    const firstMenuItem = wrapper.find('#first-menu-item-id');\n    expect(document.activeElement).toBe(firstMenuItem.element);\n  });\n});\n```\n\n##### ARIA Roles, States and Properties\n\nWe should assert that the correct ARIA states, roles and properties are set within our component.\n\n##### Text Alternatives\n\nWe should test text alternatives to ensure that visual elements in our component also have descriptive text alternatives\nfor screen readers.\n\n###### Example\n\n```js\ndescribe('MyComponent Tests', () => {\n  let wrapper;\n  let img;\n\n  const propsData = {\n    some: 'prop',\n  };\n\n  beforeEach(() => {\n    wrapper = shallowMount(MyComponent, { propsData });\n    img = wrapper.find('[data-qa=\"img\"]');\n  });\n\n  it('Has an appropriate alt attribute', () => {\n    assert.strictEqual(img.attributes('alt'), 'Some description of the image');\n    expect(img.attributes('alt')).toBe('Some description of the image');\n  });\n});\n```\n\n##### Announcements\n\nWe should also test that the correct announcements are present when interacting with the component. These are crucial in\nproviding information to visually impaired users.\n\n### Presentation\n\n#### Snapshot Testing\n\n`TODO: Pending Future Discussion`\n\n## Best Practices\n\n### Test Descriptions\n\nEach `describe` should inform us on either what is being tested or the current state of the environment. Each `it`\nshould describe what we are validating.\n\n#### Example\n\n```js\ndescribe('My Component Tests', () => {\n  describe('When some description of the current environment', () => {\n    it('Some expectation that we have asserted', () => {});\n  });\n});\n```\n\n### Single Assertions\n\nWe should aim to have a single assertion for each test. There are cases when we will have to use multiple assertions for\na test, these cases should be considered to be exceptions to the guideline.\n\n<h4 style={{ color: 'blue' }}>Acceptable</h4>\n\n```js\nit('1 equals 1 and 2 equals 2', () => {\n  expect(1).toBe(1);\n  expect(2).toBe(2);\n});\n```\n\n<h4 style={{ color: 'green' }}>Preferred</h4>\n\n```js\nit('1 equals 1', () => {\n  expect(1).toBe(1);\n});\n\nit('2 equals 2', () => {\n  expect(2).toBe(2);\n});\n```\n\n### DRY\n\nWe should ensure that repeated assertions are moved into a shared example in order to reduce repeated code. Shared\nexamples should have the following naming structure `itBehavesLike<SOME EXPECTATION>`. If an example can be shared\nacross test files then we can add it to the following directory `tests/shared_examples`.\n\n<h4 style={{ color: 'red' }}>Bad</h4>\n\n```js\ndescribe('My Tests', () => {\n  let num;\n\n  describe('When num is 1', () => {\n    num = 1;\n\n    it('equals itself', () => {\n      expect(num).toBe(num);\n    });\n  });\n\n  describe('When num is 2', () => {\n    num = 2;\n\n    it('equals itself', () => {\n      expect(num).toBe(num);\n    });\n  });\n});\n```\n\n<h4 style={{ color: 'green' }}>Good</h4>\n\n#### Closure Example\n\n```js\nconst itBehavesLikeEqualsItself = (num) => {\n  it('equals itself', () => {\n    expect(num).toBe(num);\n  });\n};\n\ndescribe('My Tests', () => {\n  let num;\n\n  describe('When num is 1', () => {\n    num = 1;\n\n    itBehavesLikeEqualsItself(num);\n  });\n\n  describe('When num is 2', () => {\n    num = 2;\n\n    itBehavesLikeEqualsItself(num);\n  });\n});\n```\n\n#### One By One Example\n\n```js\nconst itBehavesLikeEquals = (num) => ({\n  itself: expectation => {\n    expect(num).toBe(expectation);\n  },\n});\n\ndescribe('My Tests', () => {\n  let num;\n\n  describe('When num is 1', () => {\n    num = 1;\n\n    it('equals itself', () => {\n      itBehavesLikeEquals(num).itself(num);\n    });\n  });\n\n  describe('When num is 2', () => {\n    num = 2;\n\n    it('equals itself', () => {\n      itBehavesLikeEquals(num).itself(num);\n    });\n  });\n});\n```\n\n### Test Isolation\n\nWe should ensure that tests are run in isolation. Ensure that if we modify the test environment, that it is restored\nafter the test(s) are complete. Test(s) should pass no matter which order they are executed in.\n\n#### Setup\n\nWe can make use of `beforeEach` and `before / beforeAll` to set up our tests.\n\n#### Teardown\n\nWe can make use of `afterEach` and `after / afterAll` to restore the test environment to its original state.\n\n# Did we miss anything?\n\nThis is a living document that is constantly being updated, feel free to suggest new additions and changes by opening\na PR and assigning to one of the project's contributors.\n"],"names":["_createMdxContent","props","_components","_provideComponents","_jsxs","_Fragment","_jsx","Meta","MDXContent","MDXLayout"],"mappings":"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"}